<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Directory Structure Viewer</title>
    <link rel="stylesheet" href="/static/style.css">
    <script>
        function navigateTo(item) {
            const newPath = window.location.pathname === '/' ? item : `${window.location.pathname}/${item}`;
            window.location.href = newPath;
        }

        function goUpOneDirectory() {
            const currentPath = window.location.pathname;
            const upOnePath = currentPath.substring(0, currentPath.lastIndexOf('/'));
            window.location.href = upOnePath || '/';
        }
    </script>
</head>

<body>
    <header>
        <h1>Directory Structure Viewer</h1>
        <form action="/" method="post">
            <input type="text" name="search_query" value="{{ search_query }}" placeholder="Search here">
            <button type="submit">Search</button>
        </form>
        <h2>Index of {{ root_directory.replace('\\', '/') }}</h2>
        {% if not is_base_directory %}
        <button onclick="goUpOneDirectory()">Up One Directory</button>
        {% endif %}
    </header>

    {% if directory_structure %}
    <table>
        <tr>
            <th>Type</th>
            <th>Name</th>
            <th>Size</th>
            <th>Last Modified</th>
        </tr>
        {% for item, details in directory_structure.items() %}
        <tr class="{{ 'clickable' if details.is_directory else 'non-clickable' }}" {% if details.is_directory
            %}onclick="navigateTo('{{ item }}');" style="cursor: pointer;" {% endif %}>
            <td>{{ 'Directory' if details.is_directory else 'File' }}</td>
            <td>{{ item }}</td>
            <td>{{ details.size }}</td>
            <td>{{ details.last_modified }}</td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}
    {% if search_results %}
    <h2>Search Results:</h2>
    <ul>
        {% for result in search_results %}
        <li>{{ result }}</li>
        {% endfor %}
    </ul>
    {% endif %}
</body>

</html>